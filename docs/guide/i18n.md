# 国际化 (I18n) 实现指南

本项目实现了前后端全链路国际化。

## 前端实现 (React)

前端使用 `react-i18next`。

**依赖**:
```bash
bun add react-i18next i18next i18next-http-backend i18next-browser-languagedetector
```

**配置** (`src/i18n/config.ts`):
```typescript
import i18n from 'i18next'
import { initReactI18next } from 'react-i18next'
import HttpBackend from 'i18next-http-backend'
import LanguageDetector from 'i18next-browser-languagedetector'

i18n
  .use(HttpBackend)
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    fallbackLng: 'en',
    supportedLngs: ['en', 'zh'],
    interpolation: { escapeValue: false },
  })

export default i18n
```

**使用方式**:
```typescript
import { useTranslation } from 'react-i18next'

export function Component() {
  const { t } = useTranslation()
  return <h1>{t('auth.login.title')}</h1>
}
```

---

## 后端实现 (Hono)

后端使用 `i18next` 处理 API 响应消息（如错误提示）的国际化。

**中间件** (`src/middleware/i18n.ts`):
通过解析 `Accept-Language` 请求头确定用户语言。
```typescript
import { context } from 'hono/context'

export const i18nMiddleware = async (c: Context, next: Next) => {
  const lang = c.req.header('Accept-Language')?.split(',')[0] || 'zh'
  context.set('lang', lang)
  await next()
}
```

**Service 层使用**:
```typescript
import { t, getLang } from '@/shared/i18n'

export const authService = {
  async login(params) {
    const lang = getLang()
    if (error) {
      throw new Error(t('auth.invalid_code', { lng: lang }))
    }
  }
}
```
