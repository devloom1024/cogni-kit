openapi: 3.0.0
info:
  title: 金融数据服务 v2 (Python)
  version: 2.0.0
  description: |
    按资产类型分组的金融数据微服务，封装 AkShare 数据接口。

    ## 模块
    - **/akshare/stock**: 股票数据 (A股/港股/美股)
    - **/akshare/etf**: ETF 数据
    - **/akshare/fund**: 场外基金数据
    - **/indicators**: 技术指标计算

servers:
  - url: http://localhost:8001
    description: 本地开发服务器
  - url: https://api.cognikit.com/financial
    description: 生产环境服务器

tags:
  - name: Health
    description: 健康检查
  - name: Stock
    description: 股票数据 - A股/港股/美股行情与信息
  - name: ETF
    description: ETF 数据 - 场内基金行情与信息
  - name: Fund
    description: 场外基金数据 - 净值与基金信息
  - name: Indicators
    description: 技术指标计算

paths:
  # ==================== 健康检查 ====================
  /api/v1/health:
    get:
      summary: 服务健康检查
      tags: [Health]
      responses:
        "200":
          description: 服务正常
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"
                  modules:
                    type: array
                    items:
                      type: string
                    example: ["akshare", "indicators"]

  # ==================== 股票数据同步 ====================
  /api/v1/akshare/stock/list:
    get:
      summary: 获取全量股票列表 (同步用)
      description: |
        **用途**: 供定时任务同步使用。
        **数据量**: 约 5000 条。
        **AkShare**: `stock_zh_a_spot_em()`, `stock_hk_spot_em()`, `stock_us_spot_em()`
      tags: [Stock]
      parameters:
        - name: market
          in: query
          schema:
            type: string
            enum: [CN, HK, US]
          description: 市场筛选，不传返回全部
      responses:
        "200":
          description: 股票列表
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/StockListItem"

  # ==================== 股票实时行情 ====================
  /api/v1/akshare/stock/{symbol}/spot:
    get:
      summary: 获取股票实时行情
      description: |
        获取单只股票的实时行情数据。
        **AkShare**:
        - A股: `stock_zh_a_spot_em()`
        - 港股: `stock_hk_spot_em()`
        - 美股: `stock_us_spot_em()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - $ref: "#/components/parameters/Market"
      responses:
        "200":
          description: 实时行情
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockSpot"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/stock/spot/batch:
    post:
      summary: 批量获取股票实时行情
      description: 批量获取多只股票的实时行情，最多 50 只
      tags: [Stock]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [symbols]
              properties:
                symbols:
                  type: array
                  items:
                    type: object
                    properties:
                      symbol:
                        type: string
                      market:
                        type: string
                        enum: [CN, HK, US]
                  maxItems: 50
      responses:
        "200":
          description: 批量行情
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: "#/components/schemas/StockSpot"

  # ==================== 股票公司信息 ====================
  /api/v1/akshare/stock/{symbol}/profile:
    get:
      summary: 获取公司基本信息 (F10)
      description: |
        获取公司基本资料。
        **AkShare**:
        - A股: `stock_individual_info_em()` + `stock_individual_basic_info_xq()`
        - 港股: `stock_individual_basic_info_hk_xq()`
        - 美股: `stock_individual_basic_info_us_xq()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - $ref: "#/components/parameters/Market"
      responses:
        "200":
          description: 公司信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockProfile"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 股票估值数据 ====================
  /api/v1/akshare/stock/{symbol}/valuation:
    get:
      summary: 获取估值数据
      description: |
        获取市值、市盈率、市净率等数据。
        **AkShare**:
        - A股: 包含在 `stock_zh_a_spot_em()`
        - 港股: `stock_hk_indicator_eniu()`
        - 美股: 包含在 `stock_us_spot_em()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - $ref: "#/components/parameters/Market"
      responses:
        "200":
          description: 估值数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockValuation"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 股票财务数据 ====================
  /api/v1/akshare/stock/{symbol}/financial:
    get:
      summary: 获取财务数据摘要
      description: |
        获取财务指标摘要。
        **AkShare**:
        - A股: `stock_financial_abstract()`
        - 港股: `stock_financial_hk_report_em()`
        - 美股: `stock_financial_us_report_em()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - $ref: "#/components/parameters/Market"
      responses:
        "200":
          description: 财务数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockFinancial"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 股票股东信息 (仅A股) ====================
  /api/v1/akshare/stock/{symbol}/shareholders:
    get:
      summary: 获取股东信息
      description: |
        获取十大股东、股东人数等信息。**仅 A 股支持**。
        **AkShare**:
        - `stock_gdfx_top_10_em()`: 十大股东
        - `stock_gdfx_free_top_10_em()`: 十大流通股东
        - `stock_zh_a_gdhs()`: 股东人数
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 股东信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockShareholders"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 股票资金流向 (仅A股) ====================
  /api/v1/akshare/stock/{symbol}/fund-flow:
    get:
      summary: 获取资金流向
      description: |
        获取主力资金流向数据。**仅 A 股支持**。
        **AkShare**: `stock_individual_fund_flow()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 资金流向
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundFlow"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 股票五档盘口 (仅A股) ====================
  /api/v1/akshare/stock/{symbol}/bid-ask:
    get:
      summary: 获取五档盘口
      description: |
        获取买卖五档数据。**仅 A 股支持**。
        **AkShare**: `stock_bid_ask_em()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 五档盘口
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BidAsk"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 股票 K 线 ====================
  /api/v1/akshare/stock/{symbol}/kline:
    get:
      summary: 获取股票 K 线数据
      description: |
        获取历史 K 线数据 (OHLCV)，不包含技术指标计算。
        **AkShare**:
        - A股: `stock_zh_a_hist()`
        - 港股: `stock_hk_hist()`
        - 美股: `stock_us_hist()`
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - $ref: "#/components/parameters/Market"
        - $ref: "#/components/parameters/Period"
        - $ref: "#/components/parameters/Adjust"
        - $ref: "#/components/parameters/Limit"
      responses:
        "200":
          description: K 线数据
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/KLinePoint"

  # ==================== ETF 数据 ====================
  /api/v1/akshare/etf/list:
    get:
      summary: 获取全量 ETF 列表 (同步用)
      description: |
        **用途**: 供定时任务同步使用。
        **AkShare**: `fund_etf_spot_em()`
      tags: [ETF]
      responses:
        "200":
          description: ETF 列表
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/EtfListItem"

  /api/v1/akshare/etf/{symbol}/spot:
    get:
      summary: 获取 ETF 实时行情
      description: |
        获取 ETF 实时行情，包含 IOPV 和折溢价率。
        **AkShare**: `fund_etf_spot_em()`
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: ETF 行情
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EtfSpot"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/etf/{symbol}/info:
    get:
      summary: 获取 ETF 基本信息
      description: |
        获取 ETF 跟踪标的、收益表现等信息。
        **AkShare**: `fund_info_index_em()`
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: ETF 信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EtfInfo"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/etf/{symbol}/holdings:
    get:
      summary: 获取 ETF 持仓
      description: |
        获取 ETF 十大重仓股。
        **AkShare**: `fund_portfolio_hold_em()`
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - name: year
          in: query
          schema:
            type: string
            pattern: "^[0-9]{4}$"
          description: 数据年份
      responses:
        "200":
          description: 持仓列表
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holdings"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/etf/{symbol}/fund-flow:
    get:
      summary: 获取 ETF 资金流向
      description: |
        获取 ETF 资金流向数据。
        **AkShare**: 包含在 `fund_etf_spot_em()`
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 资金流向
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundFlow"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/etf/{symbol}/dividend:
    get:
      summary: 获取 ETF 分红记录
      description: |
        获取 ETF 历史分红记录。
        **AkShare**: `fund_etf_dividend_sina()`
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 分红记录
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DividendHistory"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/etf/{symbol}/kline:
    get:
      summary: 获取 ETF K 线数据
      description: |
        获取 ETF 历史 K 线数据。
        **AkShare**: `fund_etf_hist_em()`
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - $ref: "#/components/parameters/Period"
        - $ref: "#/components/parameters/Adjust"
        - $ref: "#/components/parameters/Limit"
      responses:
        "200":
          description: K 线数据
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/KLinePoint"

  # ==================== 场外基金数据 ====================
  /api/v1/akshare/fund/list:
    get:
      summary: 获取全量场外基金列表 (同步用)
      description: |
        **用途**: 供定时任务同步使用。
        **AkShare**: `fund_open_fund_daily_em()`
      tags: [Fund]
      responses:
        "200":
          description: 基金列表
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/FundListItem"

  /api/v1/akshare/fund/{symbol}/nav:
    get:
      summary: 获取基金最新净值
      description: |
        获取基金单位净值、累计净值、日增长率。
        **AkShare**: `fund_open_fund_daily_em()`
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 基金净值
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundNav"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/fund/{symbol}/info:
    get:
      summary: 获取基金基本信息
      description: |
        获取基金经理、规模、风险等级等信息。
        **AkShare**: `fund_individual_basic_info_xq()`
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 基金信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundInfo"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/fund/{symbol}/performance:
    get:
      summary: 获取基金收益表现
      description: |
        获取近期收益率数据。
        **AkShare**: `fund_open_fund_rank_em()`
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 收益表现
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundPerformance"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/fund/{symbol}/holdings:
    get:
      summary: 获取基金持仓
      description: |
        获取基金十大重仓股。
        **AkShare**: `fund_portfolio_hold_em()`
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - name: year
          in: query
          schema:
            type: string
            pattern: "^[0-9]{4}$"
          description: 数据年份
      responses:
        "200":
          description: 持仓列表
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holdings"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/fund/{symbol}/allocation:
    get:
      summary: 获取基金资产配置
      description: |
        获取股票、债券、现金等资产配置比例及行业配置。
        **AkShare**:
        - `fund_report_asset_allocation_cninfo()`: 资产配置
        - `fund_portfolio_industry_allocation_em()`: 行业配置
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 资产配置
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundAllocation"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/fund/{symbol}/estimation:
    get:
      summary: 获取基金盘中估值
      description: |
        获取基金实时估算净值（交易时间内）。
        **AkShare**: `fund_value_estimation_em()`
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
      responses:
        "200":
          description: 盘中估值
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundEstimation"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/akshare/fund/{symbol}/nav-history:
    get:
      summary: 获取基金历史净值
      description: |
        获取基金历史净值走势。
        **AkShare**: `fund_open_fund_info_em(indicator="单位净值走势")`
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/Symbol"
        - name: limit
          in: query
          schema:
            type: integer
            default: 90
            maximum: 365
          description: 返回数据点数量
      responses:
        "200":
          description: 历史净值
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NavHistory"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 技术指标计算 ====================
  /api/v1/indicators/calculate:
    post:
      summary: 计算技术指标
      description: |
        根据 K 线数据计算技术指标。

        **支持的指标**:
        - `ma(n)`: n日移动平均线
        - `ema(n)`: n日指数移动平均
        - `macd(fast,slow,signal)`: MACD
        - `rsi(n)`: RSI
        - `boll(n,std)`: 布林带
        - `kdj(n,m1,m2)`: KDJ
      tags: [Indicators]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/IndicatorRequest"
      responses:
        "200":
          description: 计算结果
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IndicatorResponse"

  /api/v1/indicators/supported:
    get:
      summary: 获取支持的指标列表
      tags: [Indicators]
      responses:
        "200":
          description: 指标列表
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/IndicatorMeta"

components:
  parameters:
    Symbol:
      name: symbol
      in: path
      required: true
      schema:
        type: string
      description: 标的代码

    Market:
      name: market
      in: query
      schema:
        type: string
        enum: [CN, HK, US]
      description: 市场类型

    Period:
      name: period
      in: query
      schema:
        type: string
        enum: [day, week, month]
        default: day
      description: K 线周期

    Adjust:
      name: adjust
      in: query
      schema:
        type: string
        enum: ["", qfq, hfq]
        default: qfq
      description: |
        复权类型:
        - 空: 不复权
        - qfq: 前复权
        - hfq: 后复权

    Limit:
      name: limit
      in: query
      schema:
        type: integer
        default: 250
        maximum: 1000
      description: 数据点数量

  responses:
    NotFound:
      description: 资源不存在
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string

    # ==================== 股票 ====================
    StockListItem:
      type: object
      properties:
        symbol:
          type: string
          description: 代码
        name:
          type: string
          description: 名称
        market:
          type: string
          enum: [CN, HK, US]
          description: 市场

    StockSpot:
      type: object
      description: 股票实时行情
      properties:
        symbol:
          type: string
        name:
          type: string
        price:
          type: number
          description: 最新价
        open:
          type: number
          description: 今开
        prevClose:
          type: number
          description: 昨收
        high:
          type: number
          description: 最高
        low:
          type: number
          description: 最低
        volume:
          type: number
          description: 成交量
        amount:
          type: number
          description: 成交额
        change:
          type: number
          description: 涨跌额
        changePercent:
          type: number
          description: 涨跌幅 (%)
        turnoverRate:
          type: number
          nullable: true
          description: 换手率 (%)
        amplitude:
          type: number
          nullable: true
          description: 振幅 (%)
        volumeRatio:
          type: number
          nullable: true
          description: 量比
        tradingStatus:
          type: string
          enum: [TRADING, CLOSED, SUSPENDED]
        timestamp:
          type: string
          format: date-time

    StockProfile:
      type: object
      description: 公司基本信息
      properties:
        symbol:
          type: string
        name:
          type: string
        fullName:
          type: string
          nullable: true
        englishName:
          type: string
          nullable: true
        industry:
          type: string
          nullable: true
        listingDate:
          type: string
          format: date
          nullable: true
        totalShares:
          type: number
          nullable: true
          description: 总股本 (亿股)
        floatShares:
          type: number
          nullable: true
          description: 流通股 (亿股)
        mainBusiness:
          type: string
          nullable: true
        registeredCapital:
          type: number
          nullable: true
        employeeCount:
          type: integer
          nullable: true
        legalRepresentative:
          type: string
          nullable: true
        secretary:
          type: string
          nullable: true
        website:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        address:
          type: string
          nullable: true

    StockValuation:
      type: object
      properties:
        symbol:
          type: string
        marketCap:
          type: number
          nullable: true
          description: 总市值 (亿元)
        floatMarketCap:
          type: number
          nullable: true
          description: 流通市值 (亿元)
        pe:
          type: number
          nullable: true
          description: 市盈率
        pb:
          type: number
          nullable: true
          description: 市净率
        dividendYield:
          type: number
          nullable: true
          description: 股息率 (%)
        change60d:
          type: number
          nullable: true
          description: 60日涨跌幅 (%)
        changeYtd:
          type: number
          nullable: true
          description: 年初至今涨跌幅 (%)

    StockFinancial:
      type: object
      properties:
        symbol:
          type: string
        reportDate:
          type: string
          format: date
        revenue:
          type: number
          nullable: true
          description: 营业收入 (亿元)
        netProfit:
          type: number
          nullable: true
          description: 净利润 (亿元)
        eps:
          type: number
          nullable: true
          description: 每股收益
        bvps:
          type: number
          nullable: true
          description: 每股净资产
        roe:
          type: number
          nullable: true
          description: ROE (%)
        grossMargin:
          type: number
          nullable: true
          description: 毛利率 (%)
        debtRatio:
          type: number
          nullable: true
          description: 资产负债率 (%)

    StockShareholders:
      type: object
      properties:
        symbol:
          type: string
        shareholderCount:
          type: integer
          nullable: true
        fundHoldingRatio:
          type: number
          nullable: true
          description: 基金持股比例 (%)
        top10Shareholders:
          type: array
          items:
            $ref: "#/components/schemas/ShareholderItem"
        top10FloatShareholders:
          type: array
          items:
            $ref: "#/components/schemas/ShareholderItem"

    ShareholderItem:
      type: object
      properties:
        name:
          type: string
        shares:
          type: number
          description: 持股数 (万股)
        percentage:
          type: number
          description: 持股比例 (%)
        change:
          type: string
          nullable: true

    BidAsk:
      type: object
      properties:
        symbol:
          type: string
        bids:
          type: array
          items:
            $ref: "#/components/schemas/PriceLevel"
        asks:
          type: array
          items:
            $ref: "#/components/schemas/PriceLevel"
        upperLimit:
          type: number
          nullable: true
          description: 涨停价
        lowerLimit:
          type: number
          nullable: true
          description: 跌停价
        outerVolume:
          type: number
          nullable: true
          description: 外盘
        innerVolume:
          type: number
          nullable: true
          description: 内盘

    PriceLevel:
      type: object
      properties:
        price:
          type: number
        volume:
          type: number

    FundFlow:
      type: object
      properties:
        symbol:
          type: string
        mainNetInflow:
          type: number
          description: 主力净流入 (万元)
        mainNetInflowRatio:
          type: number
          nullable: true
          description: 主力净流入占比 (%)
        superLargeNetInflow:
          type: number
          nullable: true
        largeNetInflow:
          type: number
          nullable: true
        mediumNetInflow:
          type: number
          nullable: true
        smallNetInflow:
          type: number
          nullable: true

    KLinePoint:
      type: object
      required: [timestamp, open, high, low, close, volume]
      properties:
        timestamp:
          type: number
          description: 时间戳 (毫秒)
        open:
          type: number
        high:
          type: number
        low:
          type: number
        close:
          type: number
        volume:
          type: number

    # ==================== ETF ====================
    EtfListItem:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string

    EtfSpot:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string
        price:
          type: number
        change:
          type: number
        changePercent:
          type: number
        iopv:
          type: number
          description: IOPV 估值
        premium:
          type: number
          description: 折溢价率 (%)
        open:
          type: number
        prevClose:
          type: number
        high:
          type: number
        low:
          type: number
        volume:
          type: number
        amount:
          type: number
        turnoverRate:
          type: number
          nullable: true
        shares:
          type: number
          nullable: true
          description: 份额 (亿份)
        marketCap:
          type: number
          nullable: true
        tradingStatus:
          type: string
          enum: [TRADING, CLOSED, SUSPENDED]
        timestamp:
          type: string
          format: date-time

    EtfInfo:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string
        trackingIndex:
          type: string
          nullable: true
        trackingType:
          type: string
          nullable: true
        nav:
          type: number
          nullable: true
        dailyReturn:
          type: number
          nullable: true
        return1w:
          type: number
          nullable: true
        return1m:
          type: number
          nullable: true
        return3m:
          type: number
          nullable: true
        return1y:
          type: number
          nullable: true
        fee:
          type: number
          nullable: true
        minPurchase:
          type: string
          nullable: true

    DividendHistory:
      type: object
      properties:
        symbol:
          type: string
        dividends:
          type: array
          items:
            type: object
            properties:
              recordDate:
                type: string
                format: date
              exDate:
                type: string
                format: date
              dividendPerUnit:
                type: number

    # ==================== 场外基金 ====================
    FundListItem:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string

    FundNav:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string
        nav:
          type: number
          description: 单位净值
        accNav:
          type: number
          description: 累计净值
        dailyReturn:
          type: number
          description: 日增长率 (%)
        dailyChange:
          type: number
          nullable: true
        navDate:
          type: string
          format: date
        prevNav:
          type: number
          nullable: true
        subscriptionStatus:
          type: string
          nullable: true
        redemptionStatus:
          type: string
          nullable: true
        fee:
          type: number
          nullable: true

    FundInfo:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string
        fullName:
          type: string
          nullable: true
        type:
          type: string
          nullable: true
        manager:
          type: string
          nullable: true
        company:
          type: string
          nullable: true
        scale:
          type: string
          nullable: true
        establishmentDate:
          type: string
          format: date
          nullable: true
        custodian:
          type: string
          nullable: true
        riskLevel:
          type: string
          nullable: true
        rating:
          type: string
          nullable: true
        benchmark:
          type: string
          nullable: true
        investmentStrategy:
          type: string
          nullable: true
        investmentObjective:
          type: string
          nullable: true

    FundPerformance:
      type: object
      properties:
        symbol:
          type: string
        return1w:
          type: number
          nullable: true
        return1m:
          type: number
          nullable: true
        return3m:
          type: number
          nullable: true
        return6m:
          type: number
          nullable: true
        return1y:
          type: number
          nullable: true
        return2y:
          type: number
          nullable: true
        return3y:
          type: number
          nullable: true
        returnYtd:
          type: number
          nullable: true
        returnSinceInception:
          type: number
          nullable: true

    FundAllocation:
      type: object
      properties:
        symbol:
          type: string
        assets:
          type: object
          properties:
            stock:
              type: number
              nullable: true
            bond:
              type: number
              nullable: true
            cash:
              type: number
              nullable: true
            other:
              type: number
              nullable: true
        industries:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              percentage:
                type: number
              categoryAvg:
                type: number
                nullable: true

    FundEstimation:
      type: object
      properties:
        symbol:
          type: string
        estimatedNav:
          type: number
        estimatedReturn:
          type: number
        estimatedTime:
          type: string
          format: date-time

    NavHistory:
      type: object
      properties:
        symbol:
          type: string
        data:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
              nav:
                type: number
              accNav:
                type: number

    Holdings:
      type: object
      properties:
        symbol:
          type: string
        reportDate:
          type: string
          format: date
        holdings:
          type: array
          items:
            $ref: "#/components/schemas/HoldingItem"

    HoldingItem:
      type: object
      properties:
        symbol:
          type: string
        name:
          type: string
        percentage:
          type: number
        shares:
          type: number
          nullable: true
        marketValue:
          type: number
          nullable: true
        change:
          type: string
          nullable: true

    # ==================== 技术指标 ====================
    IndicatorRequest:
      type: object
      required: [data, indicators]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/KLinePoint"
        indicators:
          type: array
          items:
            type: string
          example: ["ma(5)", "ma(20)", "macd(12,26,9)"]

    IndicatorResponse:
      type: object
      additionalProperties: true
      example:
        ma(5): [null, null, null, null, 10.12, 10.25]
        macd(12,26,9):
          dif: [0.15, 0.18, 0.22]
          dea: [0.10, 0.12, 0.14]
          histogram: [0.05, 0.06, 0.08]

    IndicatorMeta:
      type: object
      properties:
        name:
          type: string
        syntax:
          type: string
        description:
          type: string
        parameters:
          type: array
          items:
            type: string
        example:
          type: string
