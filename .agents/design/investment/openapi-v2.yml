openapi: 3.0.0
info:
  title: 投资模块 API v2
  version: 2.0.0
  description: |
    按资产类型分组的投资模块 API，支持股票、ETF 和场外基金的详情查询。

    ## 设计原则
    - **按资产类型分组**: `/stocks/`, `/etfs/`, `/funds/`
    - **按数据模块拆分**: 行情、资料、财务、持仓等独立接口
    - **按需加载**: 前端可按需请求各模块数据

servers:
  - url: http://localhost:3001
    description: 本地开发服务器
  - url: https://api.cognikit.com
    description: 生产环境服务器

tags:
  - name: Asset
    description: 资产搜索与通用接口
  - name: Stock
    description: 股票详情接口 (A股/港股/美股)
  - name: ETF
    description: 场内基金详情接口
  - name: Fund
    description: 场外基金详情接口
  - name: Watchlist
    description: 自选列表管理

paths:
  # ==================== 资产搜索 (通用) ====================
  /api/v1/investment/assets/search:
    get:
      summary: 搜索标的
      description: 通过代码、名称或拼音搜索所有类型的标的 (股票/ETF/基金)
      tags: [Asset]
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 50
          description: 搜索关键词
        - name: type
          in: query
          required: false
          schema:
            type: string
            enum: [STOCK, ETF, FUND]
          description: 筛选资产类型
        - name: market
          in: query
          required: false
          schema:
            type: string
            enum: [CN, HK, US]
          description: 筛选市场 (仅股票有效)
        - name: page
          in: query
          schema:
            type: integer
            default: 1
            minimum: 1
          description: 页码
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
          description: 每页数量
      responses:
        "200":
          description: 搜索结果
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AssetSearchResponse"

  # ==================== 股票接口 ====================
  /api/v1/investment/stocks/{id}/quote:
    get:
      summary: 获取股票实时行情(含五档盘口)
      description: |
        获取股票最新价格、成交量、涨跌幅等实时数据。

        **A股**: 返回完整行情数据(含五档盘口、涨跌停价、内外盘等)
        **港股/美股**: 返回基础行情数据(不含五档盘口)
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 实时行情数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockQuote"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/stocks/{id}/profile:
    get:
      summary: 获取公司基本信息 (F10)
      description: 获取公司全称、所属行业、主营业务、上市日期等信息
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 公司基本信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockProfile"
        "404":
          $ref: "#/components/responses/NotFound"

  # /valuation 接口已删除 - 估值数据请使用 /profile 接口获取

  /api/v1/investment/stocks/{id}/financial:
    get:
      summary: 获取财务数据摘要
      description: 获取营收、净利润、每股收益、ROE 等财务指标
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 财务数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockFinancial"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/stocks/{id}/shareholders:
    get:
      summary: 获取股东信息
      description: 获取十大股东、股东人数等信息 (仅 A 股支持)
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 股东信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StockShareholders"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/stocks/{id}/fund-flow:
    get:
      summary: 获取资金流向
      description: 获取主力、大单、中单、小单资金流向 (仅 A 股支持)
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 资金流向数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundFlow"
        "404":
          $ref: "#/components/responses/NotFound"

  # /bid-ask 接口已删除 - 五档盘口数据已包含在 /quote 接口中

  /api/v1/investment/stocks/{id}/kline:
    get:
      summary: 获取 K 线数据
      description: 获取历史 K 线数据和技术指标
      tags: [Stock]
      parameters:
        - $ref: "#/components/parameters/AssetId"
        - $ref: "#/components/parameters/KLinePeriod"
        - $ref: "#/components/parameters/KLineLimit"
        - $ref: "#/components/parameters/Indicators"
      responses:
        "200":
          description: K 线数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/KLineResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== ETF 接口 ====================
  /api/v1/investment/etfs/{id}/quote:
    get:
      summary: 获取 ETF 实时行情
      description: 获取 ETF 最新价格、IOPV、折溢价率等实时数据
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: ETF 实时行情
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EtfQuote"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/etfs/{id}/info:
    get:
      summary: 获取 ETF 基本信息
      description: 获取跟踪标的、基金类型、收益表现等信息
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: ETF 基本信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EtfInfo"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/etfs/{id}/holdings:
    get:
      summary: 获取 ETF 十大重仓股
      description: 获取 ETF 的十大重仓股列表
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/AssetId"
        - name: year
          in: query
          schema:
            type: string
            pattern: "^[0-9]{4}$"
          description: 数据年份，不传返回最新
      responses:
        "200":
          description: 持仓列表
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holdings"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/etfs/{id}/fund-flow:
    get:
      summary: 获取 ETF 资金流向
      description: 获取 ETF 的资金流向数据
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 资金流向数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundFlow"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/etfs/{id}/dividend:
    get:
      summary: 获取 ETF 分红记录
      description: 获取 ETF 的历史分红记录
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 分红记录
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DividendHistory"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/etfs/{id}/kline:
    get:
      summary: 获取 ETF K 线数据
      description: 获取 ETF 历史 K 线数据和技术指标
      tags: [ETF]
      parameters:
        - $ref: "#/components/parameters/AssetId"
        - $ref: "#/components/parameters/KLinePeriod"
        - $ref: "#/components/parameters/KLineLimit"
        - $ref: "#/components/parameters/Indicators"
      responses:
        "200":
          description: K 线数据
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/KLineResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 场外基金接口 ====================
  /api/v1/investment/funds/{id}/nav:
    get:
      summary: 获取基金最新净值
      description: 获取基金单位净值、累计净值、日增长率等
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 基金净值
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundNav"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/funds/{id}/info:
    get:
      summary: 获取基金基本信息
      description: 获取基金经理、规模、风险等级、成立日期等信息
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 基金基本信息
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundInfo"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/funds/{id}/performance:
    get:
      summary: 获取基金收益表现
      description: 获取近1周、1月、3月、1年等收益率
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 收益表现
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundPerformance"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/funds/{id}/holdings:
    get:
      summary: 获取基金十大重仓股
      description: 获取基金的十大重仓股列表
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
        - name: year
          in: query
          schema:
            type: string
            pattern: "^[0-9]{4}$"
          description: 数据年份，不传返回最新
      responses:
        "200":
          description: 持仓列表
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holdings"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/funds/{id}/allocation:
    get:
      summary: 获取基金资产配置
      description: 获取股票、债券、现金等资产配置比例及行业配置
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 资产配置
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundAllocation"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/funds/{id}/estimation:
    get:
      summary: 获取基金盘中估值
      description: 获取基金的实时估算净值 (交易时间内)
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
      responses:
        "200":
          description: 盘中估值
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundEstimation"
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/funds/{id}/nav-history:
    get:
      summary: 获取基金历史净值
      description: 获取基金的历史净值走势数据
      tags: [Fund]
      parameters:
        - $ref: "#/components/parameters/AssetId"
        - name: limit
          in: query
          schema:
            type: integer
            default: 90
            maximum: 365
          description: 返回的数据点数量
      responses:
        "200":
          description: 历史净值
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NavHistory"
        "404":
          $ref: "#/components/responses/NotFound"

  # ==================== 自选列表 (保持原有设计) ====================
  /api/v1/investment/watchlist/groups:
    get:
      summary: 获取所有自选分组
      tags: [Watchlist]
      security:
        - bearerAuth: []
      responses:
        "200":
          description: 分组列表
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WatchlistGroup"
        "401":
          $ref: "#/components/responses/Unauthorized"
    post:
      summary: 创建自选分组
      tags: [Watchlist]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 50
                  description: 分组名称
      responses:
        "201":
          description: 创建成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WatchlistGroup"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /api/v1/investment/watchlist/groups/{id}:
    patch:
      summary: 更新自选分组
      tags: [Watchlist]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: 分组 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: 新组名
                sortOrder:
                  type: integer
                  description: 排序权重
      responses:
        "200":
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WatchlistGroup"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      summary: 删除自选分组
      tags: [Watchlist]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: 分组 ID
      responses:
        "204":
          description: 删除成功
        "404":
          $ref: "#/components/responses/NotFound"

  /api/v1/investment/watchlist/items:
    post:
      summary: 添加标的到自选
      tags: [Watchlist]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [assetId, groupId]
              properties:
                assetId:
                  type: string
                  description: 标的 ID
                groupId:
                  type: string
                  description: 分组 ID
      responses:
        "201":
          description: 添加成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WatchlistItem"
        "409":
          description: 已存在
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/v1/investment/watchlist/items/{id}:
    patch:
      summary: 移动/排序自选项
      tags: [Watchlist]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupId:
                  type: string
                sortOrder:
                  type: integer
      responses:
        "200":
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WatchlistItem"
    delete:
      summary: 移除自选
      tags: [Watchlist]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "204":
          description: 删除成功

  /api/v1/investment/watchlist/quotes:
    post:
      summary: 批量获取自选行情
      description: 根据自选列表批量获取行情数据，自动识别类型
      tags: [Watchlist]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [ids]
              properties:
                ids:
                  type: array
                  items:
                    type: string
                  maxItems: 50
                  description: 标的 ID 列表
      responses:
        "200":
          description: 批量行情
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: "#/components/schemas/QuoteSummary"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    AssetId:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: 标的唯一 ID

    KLinePeriod:
      name: period
      in: query
      required: true
      schema:
        type: string
        enum: [day, week, month]
      description: |
        K 线周期:
        - day: 日线
        - week: 周线
        - month: 月线

    KLineLimit:
      name: limit
      in: query
      schema:
        type: integer
        default: 250
        maximum: 1000
      description: 返回的数据点数量，最多 1000 条

    Indicators:
      name: indicators
      in: query
      schema:
        type: string
      description: |
        技术指标表达式，逗号分隔。支持的指标:
        - ma(n): n日移动平均线
        - ema(n): n日指数移动平均
        - macd(fast,slow,signal): MACD 指标
        - rsi(n): RSI 相对强弱指标
        - boll(n,std): 布林带
        - kdj(n,m1,m2): KDJ 指标

  responses:
    NotFound:
      description: 资源不存在
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

    Unauthorized:
      description: 未授权
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

  schemas:
    # ==================== 通用 ====================
    Error:
      type: object
      required: [code, message]
      properties:
        code:
          type: string
          description: 错误码
        message:
          type: string
          description: 错误信息

    PaginationMeta:
      type: object
      description: 分页元数据
      properties:
        total:
          type: integer
          description: 总记录数
        page:
          type: integer
          description: 当前页码
        limit:
          type: integer
          description: 每页数量
        totalPages:
          type: integer
          description: 总页数

    AssetType:
      type: string
      enum: [STOCK, ETF, FUND]
      description: |
        资产类型:
        - STOCK: 股票
        - ETF: 场内基金
        - FUND: 场外基金

    AssetMarket:
      type: string
      enum: [CN, HK, US]
      description: |
        市场:
        - CN: A股
        - HK: 港股
        - US: 美股

    TradingStatus:
      type: string
      enum: [TRADING, CLOSED, SUSPENDED]
      description: |
        交易状态:
        - TRADING: 交易中
        - CLOSED: 休市
        - SUSPENDED: 停牌

    # ==================== 搜索 ====================
    AssetSearchResult:
      type: object
      properties:
        id:
          type: string
          description: 标的 ID
        symbol:
          type: string
          description: 代码
        name:
          type: string
          description: 名称
        type:
          $ref: "#/components/schemas/AssetType"
        market:
          $ref: "#/components/schemas/AssetMarket"

    AssetSearchResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/AssetSearchResult"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    # ==================== 股票 ====================
    StockQuote:
      type: object
      description: 股票实时行情(A股含五档盘口)
      properties:
        symbol:
          type: string
          description: 代码
        name:
          type: string
          nullable: true
          description: 名称
        price:
          type: number
          description: 最新价
        change:
          type: number
          description: 涨跌额
        changePercent:
          type: number
          description: 涨跌幅 (%)
        open:
          type: number
          description: 今开
        prevClose:
          type: number
          description: 昨收
        high:
          type: number
          description: 最高
        low:
          type: number
          description: 最低
        avgPrice:
          type: number
          nullable: true
          description: 均价
        volume:
          type: number
          description: 成交量 (手)
        amount:
          type: number
          description: 成交额 (元)
        turnoverRate:
          type: number
          nullable: true
          description: 换手率 (%)
        amplitude:
          type: number
          nullable: true
          description: 振幅 (%)
        volumeRatio:
          type: number
          nullable: true
          description: 量比
        upperLimit:
          type: number
          nullable: true
          description: 涨停价
        lowerLimit:
          type: number
          nullable: true
          description: 跌停价
        outerVolume:
          type: number
          nullable: true
          description: 外盘(手)
        innerVolume:
          type: number
          nullable: true
          description: 内盘(手)
        bid1:
          type: number
          nullable: true
          description: 买一价
        bid1Volume:
          type: number
          nullable: true
          description: 买一量(手)
        bid2:
          type: number
          nullable: true
          description: 买二价
        bid2Volume:
          type: number
          nullable: true
          description: 买二量(手)
        bid3:
          type: number
          nullable: true
          description: 买三价
        bid3Volume:
          type: number
          nullable: true
          description: 买三量(手)
        bid4:
          type: number
          nullable: true
          description: 买四价
        bid4Volume:
          type: number
          nullable: true
          description: 买四量(手)
        bid5:
          type: number
          nullable: true
          description: 买五价
        bid5Volume:
          type: number
          nullable: true
          description: 买五量(手)
        ask1:
          type: number
          nullable: true
          description: 卖一价
        ask1Volume:
          type: number
          nullable: true
          description: 卖一量(手)
        ask2:
          type: number
          nullable: true
          description: 卖二价
        ask2Volume:
          type: number
          nullable: true
          description: 卖二量(手)
        ask3:
          type: number
          nullable: true
          description: 卖三价
        ask3Volume:
          type: number
          nullable: true
          description: 卖三量(手)
        ask4:
          type: number
          nullable: true
          description: 卖四价
        ask4Volume:
          type: number
          nullable: true
          description: 卖四量(手)
        ask5:
          type: number
          nullable: true
          description: 卖五价
        ask5Volume:
          type: number
          nullable: true
          description: 卖五量(手)
        tradingStatus:
          $ref: "#/components/schemas/TradingStatus"
        timestamp:
          type: string
          format: date-time
          description: 更新时间

    StockProfile:
      type: object
      description: 公司基本信息
      properties:
        symbol:
          type: string
        name:
          type: string
        fullName:
          type: string
          nullable: true
          description: 公司全称
        englishName:
          type: string
          nullable: true
          description: 英文名
        industry:
          type: string
          nullable: true
          description: 所属行业
        listingDate:
          type: string
          format: date
          nullable: true
          description: 上市日期
        totalShares:
          type: number
          nullable: true
          description: 总股本 (亿股)
        floatShares:
          type: number
          nullable: true
          description: 流通股 (亿股)
        mainBusiness:
          type: string
          nullable: true
          description: 主营业务
        registeredCapital:
          type: number
          nullable: true
          description: 注册资本 (亿元)
        employeeCount:
          type: integer
          nullable: true
          description: 员工人数
        legalRepresentative:
          type: string
          nullable: true
          description: 法人代表
        secretary:
          type: string
          nullable: true
          description: 董秘
        website:
          type: string
          nullable: true
          description: 公司官网
        phone:
          type: string
          nullable: true
          description: 联系电话
        address:
          type: string
          nullable: true
          description: 办公地址

    StockValuation:
      type: object
      description: 估值数据
      properties:
        symbol:
          type: string
        marketCap:
          type: number
          nullable: true
          description: 总市值 (亿元)
        floatMarketCap:
          type: number
          nullable: true
          description: 流通市值 (亿元)
        pe:
          type: number
          nullable: true
          description: 市盈率 (TTM)
        pb:
          type: number
          nullable: true
          description: 市净率
        dividendYield:
          type: number
          nullable: true
          description: 股息率 (%)
        change60d:
          type: number
          nullable: true
          description: 60日涨跌幅 (%)
        changeYtd:
          type: number
          nullable: true
          description: 年初至今涨跌幅 (%)

    StockFinancial:
      type: object
      description: 财务数据摘要
      properties:
        symbol:
          type: string
        reportDate:
          type: string
          format: date
          description: 报告期
        revenue:
          type: number
          nullable: true
          description: 营业收入 (亿元)
        netProfit:
          type: number
          nullable: true
          description: 净利润 (亿元)
        eps:
          type: number
          nullable: true
          description: 每股收益
        bvps:
          type: number
          nullable: true
          description: 每股净资产
        roe:
          type: number
          nullable: true
          description: 净资产收益率 (%)
        grossMargin:
          type: number
          nullable: true
          description: 毛利率 (%)
        debtRatio:
          type: number
          nullable: true
          description: 资产负债率 (%)

    StockShareholders:
      type: object
      description: 股东信息
      properties:
        symbol:
          type: string
        shareholderCount:
          type: integer
          nullable: true
          description: 股东人数
        fundHoldingRatio:
          type: number
          nullable: true
          description: 基金持股比例 (%)
        top10Shareholders:
          type: array
          description: 十大股东
          items:
            $ref: "#/components/schemas/ShareholderItem"
        top10FloatShareholders:
          type: array
          description: 十大流通股东
          items:
            $ref: "#/components/schemas/ShareholderItem"

    ShareholderItem:
      type: object
      properties:
        name:
          type: string
          description: 股东名称
        shares:
          type: number
          description: 持股数 (万股)
        percentage:
          type: number
          description: 持股比例 (%)
        change:
          type: string
          nullable: true
          description: 变动 (增持/减持/不变)

    BidAsk:
      type: object
      description: 五档盘口 (仅 A 股)
      properties:
        symbol:
          type: string
        bids:
          type: array
          description: 买盘 (买1-买5)
          items:
            $ref: "#/components/schemas/PriceLevel"
        asks:
          type: array
          description: 卖盘 (卖1-卖5)
          items:
            $ref: "#/components/schemas/PriceLevel"
        upperLimit:
          type: number
          nullable: true
          description: 涨停价
        lowerLimit:
          type: number
          nullable: true
          description: 跌停价
        outerVolume:
          type: number
          nullable: true
          description: 外盘
        innerVolume:
          type: number
          nullable: true
          description: 内盘

    PriceLevel:
      type: object
      properties:
        price:
          type: number
          description: 价格
        volume:
          type: number
          description: 数量 (手)

    FundFlow:
      type: object
      description: 资金流向
      properties:
        symbol:
          type: string
        mainNetInflow:
          type: number
          description: 主力净流入 (万元)
        mainNetInflowRatio:
          type: number
          nullable: true
          description: 主力净流入占比 (%)
        superLargeNetInflow:
          type: number
          nullable: true
          description: 超大单净流入 (万元)
        largeNetInflow:
          type: number
          nullable: true
          description: 大单净流入 (万元)
        mediumNetInflow:
          type: number
          nullable: true
          description: 中单净流入 (万元)
        smallNetInflow:
          type: number
          nullable: true
          description: 小单净流入 (万元)

    # ==================== ETF ====================
    EtfQuote:
      type: object
      description: ETF 实时行情
      properties:
        symbol:
          type: string
        name:
          type: string
        price:
          type: number
          description: 最新价
        change:
          type: number
          description: 涨跌额
        changePercent:
          type: number
          description: 涨跌幅 (%)
        iopv:
          type: number
          description: IOPV 实时估值
        premium:
          type: number
          description: 折溢价率 (%)
        open:
          type: number
          description: 今开
        prevClose:
          type: number
          description: 昨收
        high:
          type: number
          description: 最高
        low:
          type: number
          description: 最低
        volume:
          type: number
          description: 成交量 (手)
        amount:
          type: number
          description: 成交额 (元)
        turnoverRate:
          type: number
          nullable: true
          description: 换手率 (%)
        shares:
          type: number
          nullable: true
          description: 最新份额 (亿份)
        marketCap:
          type: number
          nullable: true
          description: 总市值 (亿元)
        tradingStatus:
          $ref: "#/components/schemas/TradingStatus"
        timestamp:
          type: string
          format: date-time
          description: 数据更新时间

    EtfInfo:
      type: object
      description: ETF 基本信息
      properties:
        symbol:
          type: string
        name:
          type: string
        trackingIndex:
          type: string
          nullable: true
          description: 跟踪标的
        trackingType:
          type: string
          nullable: true
          description: 跟踪类型 (被动/增强)
        nav:
          type: number
          nullable: true
          description: 单位净值
        dailyReturn:
          type: number
          nullable: true
          description: 日增长率 (%)
        return1w:
          type: number
          nullable: true
          description: 近1周收益 (%)
        return1m:
          type: number
          nullable: true
          description: 近1月收益 (%)
        return3m:
          type: number
          nullable: true
          description: 近3月收益 (%)
        return1y:
          type: number
          nullable: true
          description: 近1年收益 (%)
        fee:
          type: number
          nullable: true
          description: 管理费 (%)
        minPurchase:
          type: string
          nullable: true
          description: 起购金额

    DividendHistory:
      type: object
      properties:
        symbol:
          type: string
        dividends:
          type: array
          items:
            type: object
            properties:
              recordDate:
                type: string
                format: date
                description: 登记日
              exDate:
                type: string
                format: date
                description: 除息日
              dividendPerUnit:
                type: number
                description: 每份分红 (元)

    # ==================== 场外基金 ====================
    FundNav:
      type: object
      description: 基金净值
      properties:
        symbol:
          type: string
        name:
          type: string
        nav:
          type: number
          description: 单位净值
        accNav:
          type: number
          description: 累计净值
        dailyReturn:
          type: number
          description: 日增长率 (%)
        dailyChange:
          type: number
          nullable: true
          description: 日增长值
        navDate:
          type: string
          format: date
          description: 净值日期
        prevNav:
          type: number
          nullable: true
          description: 前一日净值
        subscriptionStatus:
          type: string
          nullable: true
          description: 申购状态
        redemptionStatus:
          type: string
          nullable: true
          description: 赎回状态
        fee:
          type: number
          nullable: true
          description: 手续费 (%)

    FundInfo:
      type: object
      description: 基金基本信息
      properties:
        symbol:
          type: string
        name:
          type: string
        fullName:
          type: string
          nullable: true
          description: 基金全称
        type:
          type: string
          nullable: true
          description: 基金类型
        manager:
          type: string
          nullable: true
          description: 基金经理
        company:
          type: string
          nullable: true
          description: 基金公司
        scale:
          type: string
          nullable: true
          description: 最新规模
        establishmentDate:
          type: string
          format: date
          nullable: true
          description: 成立日期
        custodian:
          type: string
          nullable: true
          description: 托管银行
        riskLevel:
          type: string
          nullable: true
          description: 风险等级
        rating:
          type: string
          nullable: true
          description: 基金评级
        benchmark:
          type: string
          nullable: true
          description: 业绩比较基准
        investmentStrategy:
          type: string
          nullable: true
          description: 投资策略
        investmentObjective:
          type: string
          nullable: true
          description: 投资目标

    FundPerformance:
      type: object
      description: 基金收益表现
      properties:
        symbol:
          type: string
        return1w:
          type: number
          nullable: true
          description: 近1周收益 (%)
        return1m:
          type: number
          nullable: true
          description: 近1月收益 (%)
        return3m:
          type: number
          nullable: true
          description: 近3月收益 (%)
        return6m:
          type: number
          nullable: true
          description: 近6月收益 (%)
        return1y:
          type: number
          nullable: true
          description: 近1年收益 (%)
        return2y:
          type: number
          nullable: true
          description: 近2年收益 (%)
        return3y:
          type: number
          nullable: true
          description: 近3年收益 (%)
        returnYtd:
          type: number
          nullable: true
          description: 今年以来收益 (%)
        returnSinceInception:
          type: number
          nullable: true
          description: 成立以来收益 (%)

    FundAllocation:
      type: object
      description: 资产配置
      properties:
        symbol:
          type: string
        assets:
          type: object
          description: 资产配置比例
          properties:
            stock:
              type: number
              nullable: true
              description: 股票占比 (%)
            bond:
              type: number
              nullable: true
              description: 债券占比 (%)
            cash:
              type: number
              nullable: true
              description: 现金占比 (%)
            other:
              type: number
              nullable: true
              description: 其他占比 (%)
        industries:
          type: array
          description: 行业配置
          items:
            type: object
            properties:
              name:
                type: string
                description: 行业名称
              percentage:
                type: number
                description: 配置比例 (%)
              categoryAvg:
                type: number
                nullable: true
                description: 同类平均 (%)

    FundEstimation:
      type: object
      description: 盘中估值
      properties:
        symbol:
          type: string
        estimatedNav:
          type: number
          description: 估算净值
        estimatedReturn:
          type: number
          description: 估算涨跌幅 (%)
        estimatedTime:
          type: string
          format: date-time
          description: 估值时间

    NavHistory:
      type: object
      properties:
        symbol:
          type: string
        data:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
                description: 净值日期
              nav:
                type: number
                description: 单位净值
              accNav:
                type: number
                description: 累计净值

    # ==================== 持仓 (通用) ====================
    Holdings:
      type: object
      properties:
        symbol:
          type: string
        reportDate:
          type: string
          format: date
          description: 报告期
        holdings:
          type: array
          items:
            $ref: "#/components/schemas/HoldingItem"

    HoldingItem:
      type: object
      properties:
        symbol:
          type: string
          description: 持仓代码
        name:
          type: string
          description: 持仓名称
        percentage:
          type: number
          description: 持仓比例 (%)
        shares:
          type: number
          nullable: true
          description: 持仓股数 (万股)
        marketValue:
          type: number
          nullable: true
          description: 持仓市值 (万元)
        change:
          type: string
          nullable: true
          description: 变动 (新进/增持/减持/不变)

    # ==================== K 线 ====================
    KLineResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/KLinePoint"
        indicators:
          type: object
          nullable: true
          additionalProperties: true
          description: 技术指标计算结果
        meta:
          type: object
          properties:
            symbol:
              type: string
            period:
              type: string

    KLinePoint:
      type: object
      description: K 线数据点
      required: [timestamp, open, high, low, close, volume]
      properties:
        timestamp:
          type: number
          description: 时间戳 (毫秒)
        open:
          type: number
          description: 开盘价
        high:
          type: number
          description: 最高价
        low:
          type: number
          description: 最低价
        close:
          type: number
          description: 收盘价
        volume:
          type: number
          description: 成交量

    # ==================== 自选列表 ====================
    WatchlistGroup:
      type: object
      description: 自选分组
      properties:
        id:
          type: string
          description: 分组 ID
        name:
          type: string
          description: 分组名称
        sortOrder:
          type: integer
          description: 排序权重
        items:
          type: array
          description: 分组内的自选项
          items:
            $ref: "#/components/schemas/WatchlistItem"
        createdAt:
          type: string
          format: date-time
          description: 创建时间

    WatchlistItem:
      type: object
      description: 自选项
      properties:
        id:
          type: string
          description: 自选项 ID
        assetId:
          type: string
          description: 关联的标的 ID
        symbol:
          type: string
          description: 标的代码
        name:
          type: string
          description: 标的名称
        type:
          $ref: "#/components/schemas/AssetType"
        market:
          $ref: "#/components/schemas/AssetMarket"
        sortOrder:
          type: integer
          description: 排序权重

    QuoteSummary:
      type: object
      description: 行情摘要 (用于列表展示)
      properties:
        price:
          type: number
          description: 最新价/净值
        change:
          type: number
          description: 涨跌额
        changePercent:
          type: number
          description: 涨跌幅 (%)
        tradingStatus:
          $ref: "#/components/schemas/TradingStatus"
        timestamp:
          type: string
          format: date-time
